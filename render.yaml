# Render.com deployment configuration
# Documentation: https://render.com/docs/blueprint-spec

services:
  - type: web
    name: wordftw
    runtime: node
    plan: free
    buildCommand: |
      cd server && npm install
      cd ../addin && npm install && npm run build
      cp -r dist/* ../server/public/
    startCommand: cd server && npm run start:production
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 10000
      - key: ALLOW_HTTP
        value: true
      # REQUIRED: JWT Authentication Secret
      # Generate via: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
      # Set this in Render dashboard (Environment > Environment Variables)
      - key: JWT_SECRET
        sync: false  # Secret - set manually in Render dashboard
      # Optional: LLM Configuration (defaults to Ollama)
      - key: LLM_PROVIDER
        value: ollama
      - key: LLM_USE_OPENAI
        value: false
      - key: OLLAMA_MODEL
        value: llama3.2:3b
      # Uncomment below if using OpenAI instead:
      # - key: LLM_PROVIDER
      #   value: openai
      # - key: LLM_USE_OPENAI
      #   value: true
      # - key: OPENAI_API_KEY
      #   sync: false  # Set this in Render dashboard
      # - key: OPENAI_MODEL
      #   value: gpt-4o-mini
    healthCheckPath: /api/v1/health

# Note: Persistent disk removed for free tier compatibility
# WARNING: Data will NOT persist across restarts on free tier!
# For persistent data, upgrade to Starter plan ($7/month)

# Note: Render free tier includes:
# - 750 hours/month of runtime (enough for always-on with 1 instance)
# - 100GB bandwidth/month
# - Automatic HTTPS
# - Services sleep after 15 minutes of inactivity (wake up on request)
# - NO persistent disk (data resets on restart/redeploy)

